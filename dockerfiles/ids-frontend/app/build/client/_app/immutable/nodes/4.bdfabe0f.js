import{s as Ct,n as Y,e as Ft,o as Rt}from"../chunks/scheduler.e108d1fd.js";import{S as $t,i as Et,g as d,s as w,h as _,j as C,c as B,y as X,f as c,k as y,a as I,x as o,A as qt,m as k,n as L,o as q,r as pt,u as vt,v as gt,d as bt,t as St,w as mt}from"../chunks/index.06801730.js";import{g as Ht,d as jt,N as Xt}from"../chunks/nav.2f1f221f.js";import{p as Qt}from"../chunks/stores.6bb18f2c.js";function rt(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}const zt=async function(n){const e=(await Ht()).total_number,s=5,l=e-(n-1)*s;let a;l-(s-1)>0?a=l-(s-1):a=1,console.log(l-n*s),console.log(a,l);const h=await jt(a,l);return Object.values(h).reverse()};function Lt(n,t,e){const s=n.slice();return s[3]=t[e],s}function Ot(n){let t,e=n[3].result+"",s;return{c(){t=d("span"),s=k(e),this.h()},l(l){t=_(l,"SPAN",{class:!0});var a=C(t);s=L(a,e),a.forEach(c),this.h()},h(){y(t,"class","badge text-bg-warning")},m(l,a){I(l,t,a),o(t,s)},p(l,a){a&1&&e!==(e=l[3].result+"")&&q(s,e)},d(l){l&&c(t)}}}function Tt(n){let t,e=n[3].result+"",s;return{c(){t=d("span"),s=k(e),this.h()},l(l){t=_(l,"SPAN",{class:!0});var a=C(t);s=L(a,e),a.forEach(c),this.h()},h(){y(t,"class","badge text-bg-success")},m(l,a){I(l,t,a),o(t,s)},p(l,a){a&1&&e!==(e=l[3].result+"")&&q(s,e)},d(l){l&&c(t)}}}function Ut(n){let t,e=n[3].result+"",s;return{c(){t=d("span"),s=k(e),this.h()},l(l){t=_(l,"SPAN",{class:!0});var a=C(t);s=L(a,e),a.forEach(c),this.h()},h(){y(t,"class","badge text-bg-danger")},m(l,a){I(l,t,a),o(t,s)},p(l,a){a&1&&e!==(e=l[3].result+"")&&q(s,e)},d(l){l&&c(t)}}}function wt(n){let t,e,s="SQLi probability",l,a=String((n[3].SQLi_probability*100).toFixed(2))+"%",h,i,r,v,E="XSS probability",b,u=String((n[3].XSS_probability*100).toFixed(2))+"%",S,f,p,D,g="Benign probability",P,R=String((n[3].Benign_probability*100).toFixed(2))+"%",H;return{c(){t=d("p"),e=d("b"),e.textContent=s,l=k(`: \r
                            `),h=k(a),i=w(),r=d("p"),v=d("b"),v.textContent=E,b=k(`: \r
                            `),S=k(u),f=w(),p=d("p"),D=d("b"),D.textContent=g,P=k(`: \r
                            `),H=k(R)},l($){t=_($,"P",{});var V=C(t);e=_(V,"B",{"data-svelte-h":!0}),X(e)!=="svelte-13v3rnc"&&(e.textContent=s),l=L(V,`: \r
                            `),h=L(V,a),V.forEach(c),i=B($),r=_($,"P",{});var z=C(r);v=_(z,"B",{"data-svelte-h":!0}),X(v)!=="svelte-1cztvkh"&&(v.textContent=E),b=L(z,`: \r
                            `),S=L(z,u),z.forEach(c),f=B($),p=_($,"P",{});var j=C(p);D=_(j,"B",{"data-svelte-h":!0}),X(D)!=="svelte-npaugu"&&(D.textContent=g),P=L(j,`: \r
                            `),H=L(j,R),j.forEach(c)},m($,V){I($,t,V),o(t,e),o(t,l),o(t,h),I($,i,V),I($,r,V),o(r,v),o(r,b),o(r,S),I($,f,V),I($,p,V),o(p,D),o(p,P),o(p,H)},p($,V){V&1&&a!==(a=String(($[3].SQLi_probability*100).toFixed(2))+"%")&&q(h,a),V&1&&u!==(u=String(($[3].XSS_probability*100).toFixed(2))+"%")&&q(S,u),V&1&&R!==(R=String(($[3].Benign_probability*100).toFixed(2))+"%")&&q(H,R)},d($){$&&(c(t),c(i),c(r),c(f),c(p))}}}function Bt(n){let t,e,s="Analysis",l,a,h=n[3].raw_gpt_response+"",i;return{c(){t=d("div"),e=d("h4"),e.textContent=s,l=w(),a=d("p"),i=k(h),this.h()},l(r){t=_(r,"DIV",{class:!0});var v=C(t);e=_(v,"H4",{"data-svelte-h":!0}),X(e)!=="svelte-11xo2qk"&&(e.textContent=s),l=B(v),a=_(v,"P",{});var E=C(a);i=L(E,h),E.forEach(c),v.forEach(c),this.h()},h(){y(t,"class","card log-card-analysis")},m(r,v){I(r,t,v),o(t,e),o(t,l),o(t,a),o(a,i)},p(r,v){v&1&&h!==(h=r[3].raw_gpt_response+"")&&q(i,h)},d(r){r&&c(t)}}}function It(n){let t,e,s,l=n[3].id+"",a,h,i,r,v="result",E,b,u,S,f="from_ip",p,D=n[3].from_ip+"",g,P,R,H,$,V="model type",z,j=n[3].model_type+"",Z,ct,T,U,Dt="timestamp",ft,J=n[3].timestamp+"",N,ht,O,M,xt="Payload",ut,G,K,W=n[3].payload+"",tt,dt,et;function yt(x,m){return x[3].result=="True"?Ut:x[3].result=="False"?Tt:Ot}let lt=yt(n),Q=lt(n),A=n[3].SQLi_probability&&wt(n),F=n[3].raw_gpt_response&&Bt(n);return{c(){t=d("div"),e=d("h2"),s=k("#"),a=k(l),h=w(),i=d("p"),r=d("b"),r.textContent=v,E=k(`: \r
                        `),Q.c(),b=w(),u=d("p"),S=d("b"),S.textContent=f,p=k(":  "),g=k(D),P=w(),A&&A.c(),R=w(),H=d("p"),$=d("b"),$.textContent=V,z=k(":  "),Z=k(j),ct=w(),T=d("p"),U=d("b"),U.textContent=Dt,ft=k(":  "),N=k(J),ht=w(),O=d("div"),M=d("h4"),M.textContent=xt,ut=w(),G=d("div"),K=d("p"),tt=k(W),dt=w(),F&&F.c(),et=w(),this.h()},l(x){t=_(x,"DIV",{class:!0});var m=C(t);e=_(m,"H2",{});var _t=C(e);s=L(_t,"#"),a=L(_t,l),_t.forEach(c),h=B(m),i=_(m,"P",{});var nt=C(i);r=_(nt,"B",{"data-svelte-h":!0}),X(r)!=="svelte-1kqdfff"&&(r.textContent=v),E=L(nt,`: \r
                        `),Q.l(nt),nt.forEach(c),b=B(m),u=_(m,"P",{});var st=C(u);S=_(st,"B",{"data-svelte-h":!0}),X(S)!=="svelte-17bqnx8"&&(S.textContent=f),p=L(st,":  "),g=L(st,D),st.forEach(c),P=B(m),A&&A.l(m),R=B(m),H=_(m,"P",{});var at=C(H);$=_(at,"B",{"data-svelte-h":!0}),X($)!=="svelte-1s188rd"&&($.textContent=V),z=L(at,":  "),Z=L(at,j),at.forEach(c),ct=B(m),T=_(m,"P",{});var it=C(T);U=_(it,"B",{"data-svelte-h":!0}),X(U)!=="svelte-yy1qoc"&&(U.textContent=Dt),ft=L(it,":  "),N=L(it,J),it.forEach(c),ht=B(m),O=_(m,"DIV",{class:!0});var ot=C(O);M=_(ot,"H4",{"data-svelte-h":!0}),X(M)!=="svelte-t1oz4s"&&(M.textContent=xt),ut=B(ot),G=_(ot,"DIV",{class:!0});var Pt=C(G);K=_(Pt,"P",{});var kt=C(K);tt=L(kt,W),kt.forEach(c),Pt.forEach(c),ot.forEach(c),dt=B(m),F&&F.l(m),et=B(m),m.forEach(c),this.h()},h(){y(G,"class","card"),y(O,"class","card log-card-payload"),y(t,"class","card log-card")},m(x,m){I(x,t,m),o(t,e),o(e,s),o(e,a),o(t,h),o(t,i),o(i,r),o(i,E),Q.m(i,null),o(t,b),o(t,u),o(u,S),o(u,p),o(u,g),o(t,P),A&&A.m(t,null),o(t,R),o(t,H),o(H,$),o(H,z),o(H,Z),o(t,ct),o(t,T),o(T,U),o(T,ft),o(T,N),o(t,ht),o(t,O),o(O,M),o(O,ut),o(O,G),o(G,K),o(K,tt),o(t,dt),F&&F.m(t,null),o(t,et)},p(x,m){m&1&&l!==(l=x[3].id+"")&&q(a,l),lt===(lt=yt(x))&&Q?Q.p(x,m):(Q.d(1),Q=lt(x),Q&&(Q.c(),Q.m(i,null))),m&1&&D!==(D=x[3].from_ip+"")&&q(g,D),x[3].SQLi_probability?A?A.p(x,m):(A=wt(x),A.c(),A.m(t,R)):A&&(A.d(1),A=null),m&1&&j!==(j=x[3].model_type+"")&&q(Z,j),m&1&&J!==(J=x[3].timestamp+"")&&q(N,J),m&1&&W!==(W=x[3].payload+"")&&q(tt,W),x[3].raw_gpt_response?F?F.p(x,m):(F=Bt(x),F.c(),F.m(t,et)):F&&(F.d(1),F=null)},d(x){x&&c(t),Q.d(),A&&A.d(),F&&F.d()}}}function Mt(n){let t,e,s,l,a,h,i,r,v="Logs",E,b,u,S=rt(n[0]),f=[];for(let p=0;p<S.length;p+=1)f[p]=It(Lt(n,S,p));return{c(){t=d("div"),e=d("div"),s=d("br"),l=w(),a=d("br"),h=w(),i=d("div"),r=d("h1"),r.textContent=v,E=w(),b=d("hr"),u=w();for(let p=0;p<f.length;p+=1)f[p].c();this.h()},l(p){t=_(p,"DIV",{class:!0});var D=C(t);e=_(D,"DIV",{class:!0});var g=C(e);s=_(g,"BR",{}),l=B(g),a=_(g,"BR",{}),h=B(g),i=_(g,"DIV",{class:!0});var P=C(i);r=_(P,"H1",{"data-svelte-h":!0}),X(r)!=="svelte-9cxgp7"&&(r.textContent=v),E=B(P),b=_(P,"HR",{}),u=B(P);for(let R=0;R<f.length;R+=1)f[R].l(P);P.forEach(c),g.forEach(c),D.forEach(c),this.h()},h(){y(i,"class","card log-card-frame"),y(e,"class","col-12"),y(t,"class","container")},m(p,D){I(p,t,D),o(t,e),o(e,s),o(e,l),o(e,a),o(e,h),o(e,i),o(i,r),o(i,E),o(i,b),o(i,u);for(let g=0;g<f.length;g+=1)f[g]&&f[g].m(i,null)},p(p,[D]){if(D&1){S=rt(p[0]);let g;for(g=0;g<S.length;g+=1){const P=Lt(p,S,g);f[g]?f[g].p(P,D):(f[g]=It(P),f[g].c(),f[g].m(i,null))}for(;g<f.length;g+=1)f[g].d(1);f.length=S.length}},i:Y,o:Y,d(p){p&&c(t),qt(f,p)}}}function Gt(n,t,e){let s;Ft(n,Qt,h=>e(1,s=h));const l=Number(s.params.slug);let a=[];return Rt(async()=>{e(0,a=await zt(l))}),[a]}class Jt extends $t{constructor(t){super(),Et(this,t,Gt,Mt,Ct,{})}}const Kt=async n=>{const e=(await Ht()).total_number;let s,l;console.log("Total Page number",e),n==1?(s=[String(n)],l=["/log/1","/log/1","/log/1"],e>5&&(s.push(String(n+1)),l.pop(),l.push("/log/2"),l.push("/log/2")),e>10&&(s.push(String(n+2)),l.pop(),l.pop(),l.push("/log/2"),l.push("/log/3"),l.push("/log/3"))):n==2?(s=[String(n-1),String(n)],l=["/log/"+String(n-1),"/log/"+String(n-1),"/log/"+String(n),"/log/"+String(n)],e>10&&(l.pop(),l.push("/log/"+String(n+1)),l.push("/log/"+String(n+1)),s.push(String(n+1)))):n<e/5?(s=[String(n-1),String(n),String(n+1)],l=["/log/"+String(n-1),"/log/"+String(n-1),"/log/"+String(n),"/log/"+String(n+1),"/log/"+String(n+1)]):(s=[String(n-2),String(n-1),String(n)],l=["/log/"+String(n-2),"/log/"+String(n-2),"/log/"+String(n-1),"/log/"+String(n),"/log/"+String(n),"/log/"+String(n)]),s.unshift("«"),s.push("»");const a=Array();for(let h=0;h<s.length;h++)a.push({token:s[h],url:l[h]});return a};function Vt(n,t,e){const s=n.slice();return s[2]=t[e],s}function At(n){let t,e,s,l=n[2].token+"",a,h,i;return{c(){t=d("li"),e=d("a"),s=d("span"),a=k(l),i=w(),this.h()},l(r){t=_(r,"LI",{class:!0});var v=C(t);e=_(v,"A",{"data-sveltekit-reload":!0,class:!0,href:!0,"aria-label":!0});var E=C(e);s=_(E,"SPAN",{"aria-hidden":!0});var b=C(s);a=L(b,l),b.forEach(c),E.forEach(c),i=B(v),v.forEach(c),this.h()},h(){y(s,"aria-hidden","true"),y(e,"data-sveltekit-reload",""),y(e,"class","page-link"),y(e,"href",h=n[2].url),y(e,"aria-label","Previous"),y(t,"class","page-item")},m(r,v){I(r,t,v),o(t,e),o(e,s),o(s,a),o(t,i)},p(r,v){v&1&&l!==(l=r[2].token+"")&&q(a,l),v&1&&h!==(h=r[2].url)&&y(e,"href",h)},d(r){r&&c(t)}}}function Wt(n){let t,e,s,l,a,h,i,r,v,E=rt(n[0]),b=[];for(let u=0;u<E.length;u+=1)b[u]=At(Vt(n,E,u));return{c(){t=d("br"),e=w(),s=d("div"),l=d("div"),a=d("div"),h=d("nav"),i=d("ul");for(let u=0;u<b.length;u+=1)b[u].c();r=w(),v=d("br"),this.h()},l(u){t=_(u,"BR",{}),e=B(u),s=_(u,"DIV",{class:!0});var S=C(s);l=_(S,"DIV",{class:!0});var f=C(l);a=_(f,"DIV",{class:!0});var p=C(a);h=_(p,"NAV",{"aria-label":!0});var D=C(h);i=_(D,"UL",{class:!0,id:!0});var g=C(i);for(let P=0;P<b.length;P+=1)b[P].l(g);g.forEach(c),D.forEach(c),p.forEach(c),f.forEach(c),S.forEach(c),r=B(u),v=_(u,"BR",{}),this.h()},h(){y(i,"class","pagination justify-content-center"),y(i,"id","log-pagination"),y(h,"aria-label","Page navigation example"),y(a,"class","col"),y(l,"class","row"),y(s,"class","container")},m(u,S){I(u,t,S),I(u,e,S),I(u,s,S),o(s,l),o(l,a),o(a,h),o(h,i);for(let f=0;f<b.length;f+=1)b[f]&&b[f].m(i,null);I(u,r,S),I(u,v,S)},p(u,[S]){if(S&1){E=rt(u[0]);let f;for(f=0;f<E.length;f+=1){const p=Vt(u,E,f);b[f]?b[f].p(p,S):(b[f]=At(p),b[f].c(),b[f].m(i,null))}for(;f<b.length;f+=1)b[f].d(1);b.length=E.length}},i:Y,o:Y,d(u){u&&(c(t),c(e),c(s),c(r),c(v)),qt(b,u)}}}function Yt(n,t,e){let s;Ft(n,Qt,a=>e(1,s=a));let l=[];return Rt(async()=>{e(0,l=await Kt(Number(s.params.slug)))}),[l]}class Zt extends $t{constructor(t){super(),Et(this,t,Yt,Wt,Ct,{})}}function Nt(n){let t,e,s,l,a,h;return t=new Xt({}),s=new Jt({}),a=new Zt({}),{c(){pt(t.$$.fragment),e=w(),pt(s.$$.fragment),l=w(),pt(a.$$.fragment)},l(i){vt(t.$$.fragment,i),e=B(i),vt(s.$$.fragment,i),l=B(i),vt(a.$$.fragment,i)},m(i,r){gt(t,i,r),I(i,e,r),gt(s,i,r),I(i,l,r),gt(a,i,r),h=!0},p:Y,i(i){h||(bt(t.$$.fragment,i),bt(s.$$.fragment,i),bt(a.$$.fragment,i),h=!0)},o(i){St(t.$$.fragment,i),St(s.$$.fragment,i),St(a.$$.fragment,i),h=!1},d(i){i&&(c(e),c(l)),mt(t,i),mt(s,i),mt(a,i)}}}class se extends $t{constructor(t){super(),Et(this,t,null,Nt,Ct,{})}}export{se as component};
